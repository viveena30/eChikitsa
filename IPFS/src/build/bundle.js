var app=function(){"use strict";function t(){}const n=t=>t;function e(t,n){for(const e in n)t[e]=n[e];return t}function o(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(o)}function a(t){return"function"==typeof t}function s(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function u(n,e,o){n.$$.on_destroy.push(function(n,...e){if(null==n)return t;const o=n.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}(e,o))}function c(t,n,e,o){if(t){const i=l(t,n,e,o);return t[0](i)}}function l(t,n,o,i){return t[1]&&i?e(o.ctx.slice(),t[1](i(n))):o.ctx}function f(t,n,e,o){if(t[2]&&o){const i=t[2](o(e));if(void 0===n.dirty)return i;if("object"==typeof i){const t=[],e=Math.max(n.dirty.length,i.length);for(let o=0;o<e;o+=1)t[o]=n.dirty[o]|i[o];return t}return n.dirty|i}return n.dirty}function p(t,n,e=n){return t.set(e),n}const d="undefined"!=typeof window;let h=d?()=>window.performance.now():()=>Date.now(),g=d?t=>requestAnimationFrame(t):t;const m=new Set;function v(t){m.forEach(n=>{n.c(t)||(m.delete(n),n.f())}),0!==m.size&&g(v)}function $(t){let n;return 0===m.size&&g(v),{promise:new Promise(e=>{m.add(n={c:t,f:e})}),abort(){m.delete(n)}}}function b(t,n){t.appendChild(n)}function y(t,n,e){t.insertBefore(n,e||null)}function k(t){t.parentNode.removeChild(t)}function x(t){return document.createElement(t)}function w(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _(t){return document.createTextNode(t)}function j(){return _(" ")}function S(){return _("")}function C(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function T(t){return function(n){return n.preventDefault(),t.call(this,n)}}function O(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function D(t,n){n=""+n,t.data!==n&&(t.data=n)}function R(t,n){(null!=n||t.value)&&(t.value=n)}function M(t,n,e,o){t.style.setProperty(n,e,o?"important":"")}function G(t,n,e){t.classList[e?"add":"remove"](n)}function I(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}const N=new Set;let A,L=0;function E(t,n,e,o,i,r,a,s=0){const u=16.666/o;let c="{\n";for(let t=0;t<=1;t+=u){const o=n+(e-n)*r(t);c+=100*t+`%{${a(o,1-o)}}\n`}const l=c+`100% {${a(e,1-e)}}\n}`,f=`__svelte_${function(t){let n=5381,e=t.length;for(;e--;)n=(n<<5)-n^t.charCodeAt(e);return n>>>0}(l)}_${s}`,p=t.ownerDocument;N.add(p);const d=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(x("style")).sheet),h=p.__svelte_rules||(p.__svelte_rules={});h[f]||(h[f]=!0,d.insertRule(`@keyframes ${f} ${l}`,d.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?g+", ":""}${f} ${o}ms linear ${i}ms 1 both`,L+=1,f}function P(t,n){const e=(t.style.animation||"").split(", "),o=e.filter(n?t=>t.indexOf(n)<0:t=>-1===t.indexOf("__svelte")),i=e.length-o.length;i&&(t.style.animation=o.join(", "),L-=i,L||g(()=>{L||(N.forEach(t=>{const n=t.__svelte_stylesheet;let e=n.cssRules.length;for(;e--;)n.deleteRule(e);t.__svelte_rules={}}),N.clear())}))}function B(t){A=t}function J(){if(!A)throw new Error("Function called outside component initialization");return A}function H(){const t=J();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const i=I(n,e);o.slice().forEach(n=>{n.call(t,i)})}}}const z=[],F=[],q=[],W=[],K=Promise.resolve();let U=!1;function V(t){q.push(t)}function Q(t){W.push(t)}let X=!1;const Y=new Set;function Z(){if(!X){X=!0;do{for(let t=0;t<z.length;t+=1){const n=z[t];B(n),tt(n.$$)}for(z.length=0;F.length;)F.pop()();for(let t=0;t<q.length;t+=1){const n=q[t];Y.has(n)||(Y.add(n),n())}q.length=0}while(z.length);for(;W.length;)W.pop()();U=!1,X=!1,Y.clear()}}function tt(t){if(null!==t.fragment){t.update(),r(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(V)}}let nt;function et(){return nt||(nt=Promise.resolve(),nt.then(()=>{nt=null})),nt}function ot(t,n,e){t.dispatchEvent(I(`${n?"intro":"outro"}${e}`))}const it=new Set;let rt;function at(){rt={r:0,c:[],p:rt}}function st(){rt.r||r(rt.c),rt=rt.p}function ut(t,n){t&&t.i&&(it.delete(t),t.i(n))}function ct(t,n,e,o){if(t&&t.o){if(it.has(t))return;it.add(t),rt.c.push(()=>{it.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}const lt={duration:0};function ft(e,o,i){let r,s,u=o(e,i),c=!1,l=0;function f(){r&&P(e,r)}function p(){const{delay:o=0,duration:i=300,easing:a=n,tick:p=t,css:d}=u||lt;d&&(r=E(e,0,1,i,o,a,d,l++)),p(0,1);const g=h()+o,m=g+i;s&&s.abort(),c=!0,V(()=>ot(e,!0,"start")),s=$(t=>{if(c){if(t>=m)return p(1,0),ot(e,!0,"end"),f(),c=!1;if(t>=g){const n=a((t-g)/i);p(n,1-n)}}return c})}let d=!1;return{start(){d||(P(e),a(u)?(u=u(),et().then(p)):p())},invalidate(){d=!1},end(){c&&(f(),c=!1)}}}function pt(e,o,i){let s,u=o(e,i),c=!0;const l=rt;function f(){const{delay:o=0,duration:i=300,easing:a=n,tick:f=t,css:p}=u||lt;p&&(s=E(e,1,0,i,o,a,p));const d=h()+o,g=d+i;V(()=>ot(e,!1,"start")),$(t=>{if(c){if(t>=g)return f(0,1),ot(e,!1,"end"),--l.r||r(l.c),!1;if(t>=d){const n=a((t-d)/i);f(1-n,n)}}return c})}return l.r+=1,a(u)?et().then(()=>{u=u(),f()}):f(),{end(t){t&&u.tick&&u.tick(1,0),c&&(s&&P(e,s),c=!1)}}}function dt(t,n){ct(t,1,1,()=>{n.delete(t.key)})}function ht(t,n,e){const o=t.$$.props[n];void 0!==o&&(t.$$.bound[o]=e,e(t.$$.ctx[o]))}function gt(t){t&&t.c()}function mt(t,n,e){const{fragment:i,on_mount:s,on_destroy:u,after_update:c}=t.$$;i&&i.m(n,e),V(()=>{const n=s.map(o).filter(a);u?u.push(...n):r(n),t.$$.on_mount=[]}),c.forEach(V)}function vt(t,n){const e=t.$$;null!==e.fragment&&(r(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function $t(t,n){-1===t.$$.dirty[0]&&(z.push(t),U||(U=!0,K.then(Z)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function bt(n,e,o,a,s,u,c=[-1]){const l=A;B(n);const f=e.props||{},p=n.$$={fragment:null,ctx:null,props:u,update:t,not_equal:s,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:i(),dirty:c};let d=!1;if(p.ctx=o?o(n,f,(t,e,...o)=>{const i=o.length?o[0]:e;return p.ctx&&s(p.ctx[t],p.ctx[t]=i)&&(p.bound[t]&&p.bound[t](i),d&&$t(n,t)),e}):[],p.update(),d=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(k)}else p.fragment&&p.fragment.c();e.intro&&ut(n.$$.fragment),mt(n,e.target,e.anchor),Z()}B(l)}class yt{$destroy(){vt(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}const kt=[];function xt({storageKey:n,initialValue:e=""}){const o=localStorage.getItem(n)||e,{subscribe:i,update:r,set:a}=function(n,e=t){let o;const i=[];function r(t){if(s(n,t)&&(n=t,o)){const t=!kt.length;for(let t=0;t<i.length;t+=1){const e=i[t];e[1](),kt.push(e,n)}if(t){for(let t=0;t<kt.length;t+=2)kt[t][0](kt[t+1]);kt.length=0}}}return{set:r,update:function(t){r(t(n))},subscribe:function(a,s=t){const u=[a,s];return i.push(u),1===i.length&&(o=e(r)||t),a(n),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(o(),o=null)}}}}(o);return i(t=>{t&&localStorage.setItem(n,t)}),{subscribe:i,update:r,set:a}}const wt=xt({storageKey:"chat_nav",initialValue:"messages"}),_t=xt({storageKey:"chat_topic",initialValue:"gundb"}),jt=xt({storageKey:"chat_user"});var St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var Ct=function(t,n){return t(n={exports:{}},n.exports),n.exports}((function(t){!function(){var n;"undefined"!=typeof window&&(n=window),void 0!==St&&(n=St);var e=(n=n||{}).console||{log:function(){}};function o(t,n){return n?function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}():t.slice?o[e(t)]:function(n,i){t(n={exports:{}}),o[e(i)]=n.exports};function e(t){return t.split("/").slice(-1).toString().replace(".js","")}}var i=t;o((function(t){var n={fn:{is:function(t){return!!t&&"function"==typeof t}}};n.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},n.num={is:function(t){return!o(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},n.text={is:function(t){return"string"==typeof t}},n.text.ify=function(t){return n.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},n.text.random=function(t,n){var e="";for(t=t||24,n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)e+=n.charAt(Math.floor(Math.random()*n.length)),t--;return e},n.text.match=function(t,n){var e,o;return"string"==typeof t&&("string"==typeof n&&(n={"=":n}),t===(e=(n=n||{})["="]||n["*"]||n[">"]||n["<"])||o===n["="]&&(e=n["*"]||n[">"]||n["<"],t.slice(0,(e||"").length)===e||o===n["*"]&&(o!==n[">"]&&o!==n["<"]?t>=n[">"]&&t<=n["<"]:o!==n[">"]&&t>=n[">"]||o!==n["<"]&&t<=n["<"])))},n.list={is:function(t){return t instanceof Array}},n.list.slit=Array.prototype.slice,n.list.sort=function(t){return function(n,e){return n&&e?(n=n[t])<(e=e[t])?-1:n>e?1:0:0}},n.list.map=function(t,n,e){return s(t,n,e)},n.list.index=1,n.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},n.obj.put=function(t,n,e){return(t||{})[n]=e,t},n.obj.has=function(t,n){return t&&Object.prototype.hasOwnProperty.call(t,n)},n.obj.del=function(t,n){if(t)return t[n]=null,delete t[n],t},n.obj.as=function(t,n,e,o){return t[n]=t[n]||(o===e?{}:e)},n.obj.ify=function(t){if(r(t))return t;try{t=JSON.parse(t)}catch(n){t={}}return t},function(){function t(t,n){a(this,n)&&void 0!==this[n]||(this[n]=t)}n.obj.to=function(n,e){return s(n,t,e=e||{}),e}}(),n.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,n){var e=this.n;if(!e||!(n===e||r(e)&&a(e,n)))return!!n||void 0}n.obj.empty=function(n,e){return!n||!s(n,t,{n:e})}}(),function(){function t(n,e){if(2===arguments.length)return t.r=t.r||{},void(t.r[n]=e);t.r=t.r||[],t.r.push(n)}var i,s=Object.keys;Object.keys=Object.keys||function(t){return i(t,(function(t,n,e){e(n)}))},n.obj.map=i=function(i,u,c){var l,f,p,d,h,g=0,m=e(u);if(t.r=null,s&&r(i)&&(d=s(i),h=!0),o(i)||d)for(f=(d||i).length;g<f;g++){var v=g+n.list.index;if(m){if((p=h?u.call(c||this,i[d[g]],d[g],t):u.call(c||this,i[g],v,t))!==l)return p}else if(u===i[h?d[g]:g])return d?d[g]:v}else for(g in i)if(m){if(a(i,g)&&(p=c?u.call(c,i[g],g,t):u(i[g],g,t))!==l)return p}else if(u===i[g])return g;return m?t.r:n.list.index?0:-1}}(),n.time={},n.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var e=n.fn.is,o=n.list.is,i=n.obj,r=i.is,a=i.has,s=i.map;t.exports=n}))(o,"./type"),o((function(t){t.exports=function t(n,e,o){if(!n)return{to:t};n=(this.tag||(this.tag={}))[n]||(this.tag[n]={tag:n,to:t._={next:function(t){var n;(n=this.to)&&n.next(t)}}});if(e instanceof Function){var i={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:e,the:n,on:this,as:o};return(i.back=n.last||n).to=i,n.last=i}return(n=n.to)&&void 0!==e&&n.next(e),n}}))(o,"./onto"),o((function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var n=JSON.stringify;t.exports=function(t,e,o,i,r){if(t<e)return{defer:!0};if(e<o)return{historical:!0};if(o<e)return{converge:!0,incoming:!0};if(e===o){if((i=n(i)||"")===(r=n(r)||""))return{state:!0};if(i<r)return{converge:!0,current:!0};if(r<i)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+i+" to "+r+" at "+e+" to "+o+"!"}}}))(o,"./HAM"),o((function(t){var n=o("./type"),e={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(s(t)||r(t)||a(t))||(e.link.is(t)||!1)))}};e.link=e.rel={_:"#"},function(){function t(t,n){var e=this;return e.id?e.id=!1:n==i&&s(t)?void(e.id=t):e.id=!1}e.link.is=function(n){if(n&&n[i]&&!n._&&c(n)){var e={};if(f(n,t,e),e.id)return e.id}return!1}}(),e.link.ify=function(t){return l({},i,t)},n.obj.has._=".";var i=e.link._,r=n.bi.is,a=n.num.is,s=n.text.is,u=n.obj,c=u.is,l=u.put,f=u.map;t.exports=e}))(o,"./val"),o((function(t){var n=o("./type"),e=o("./val"),i={_:"_",soul:function(t,n){return t&&t._&&t._[n||l]}};i.soul.ify=function(t,n){return n="string"==typeof n?{soul:n}:n||{},(t=t||{})._=t._||{},t._[l]=n.soul||t._[l]||c(),t},i.soul._=e.link._,function(){function t(t,n){if(n!==i._)return!e.is(t)||void(this.cb&&this.cb.call(this.as,t,n,this.n,this.s))}i.is=function(n,e,o){var r;return!!a(n)&&(!!(r=i.soul(n))&&!u(n,t,{as:o,cb:e,s:r,n:n}))}}(),function(){function t(t,n){var o,i=this.o;i.map?void 0===(o=i.map.call(this.as,t,""+n,i.node))?s(i.node,n):i.node&&(i.node[n]=o):e.is(t)&&(i.node[n]=t)}i.ify=function(n,e,o){return e?"string"==typeof e?e={soul:e}:e instanceof Function&&(e={map:e}):e={},e.map&&(e.node=e.map.call(o,n,void 0,e.node||{})),(e.node=i.soul.ify(e.node||{},e))&&u(n,t,{o:e,as:o}),e.node}}();var r=n.obj,a=r.is,s=r.del,u=r.map,c=n.text.random,l=i.soul._;t.exports=i}))(o,"./node"),o((function(t){var n=o("./type"),e=o("./node");function i(){var t;return t=r(),a<t?(s=0,a=t+i.drift):a=t+(s+=1)/u+i.drift}var r=n.time.is,a=-1/0,s=0,u=1e3,c="undefined"!=typeof performance&&(performance.timing&&performance);c&&c.timing&&c.timing.navigationStart||(c=!1);i._=">",i.drift=0,i.is=function(t,n,e){var o=n&&t&&t[b]&&t[b][i._]||e;if(o)return v(o=o[n])?o:-1/0},i.lex=function(){return i().toString(36).replace(".","")},i.ify=function(t,n,o,r,a){if(!t||!t[b]){if(!a)return;t=e.soul.ify(t,a)}var s=p(t[b],i._);return l!==n&&n!==b&&(v(o)&&(s[n]=o),l!==r&&(t[n]=r)),t},i.to=function(t,n,o){var r=(t||{})[n];return h(r)&&(r=m(r)),i.ify(o,n,i.is(t,n),r,e.soul(t))},function(){function t(t,n){b!==n&&i.ify(this.o,n,this.s)}i.map=function(n,e,o){var r,a=h(a=n||e)?a:null;return n=$(n=n||e)?n:null,a&&!n?(e=v(e)?e:i(),a[b]=a[b]||{},g(a,t,{o:a,s:e}),a):(o=o||h(e)?e:r,e=v(e)?e:i(),function(i,a,s,u){if(!n)return t.call({o:s,s:e},i,a),i;n.call(o||this||{},i,a,s,u),d(s,a)&&r===s[a]||t.call({o:s,s:e},i,a)})}}();var l,f=n.obj,p=f.as,d=f.has,h=f.is,g=f.map,m=f.copy,v=n.num.is,$=n.fn.is,b=e._;t.exports=i}))(o,"./state"),o((function(t){var n=o("./type"),e=o("./val"),i=o("./node"),r={};!function(){function t(t,e){if(!t||e!==i.soul(t)||!i.is(t,this.fn,this.as))return!0;this.cb&&(n.n=t,n.as=this.as,this.cb.call(n.as,t,e,n))}function n(t){t&&i.is(n.n,t,n.as)}r.is=function(n,e,o,i){return!(!n||!s(n)||l(n))&&!p(n,t,{cb:e,fn:o,as:i})}}(),function(){function t(t,n){var r;return(r=function(t,n){var e,o=t.seen,i=o.length;for(;i--;)if(e=o[i],n.obj===e.obj)return e;o.push(n)}(t,n))?r:(n.env=t,n.soul=a,i.ify(n.obj,o,n)&&(n.link=n.link||e.link.ify(i.soul(n.node)),n.obj!==t.shell&&(t.graph[e.link.is(n.link)]=n.node)),n)}function o(n,o,r){var a,s,f=this,p=f.env;if(i._===o&&c(n,e.link._))return r._;if(a=l(n,o,r,f,p)){if(o||(f.node=f.node||r||{},c(n,i._)&&i.soul(n)&&(f.node._=d(n._)),f.node=i.soul.ify(f.node,e.link.is(f.link)),f.link=f.link||e.link.ify(i.soul(f.node))),(s=p.map)&&(s.call(p.as||{},n,o,r,f),c(r,o))){if(void 0===(n=r[o]))return void u(r,o);if(!(a=l(n,o,r,f,p)))return}if(!o)return f.node;if(!0===a)return n;if((s=t(p,{obj:n,path:f.path.concat(o)})).node)return s.link}}function a(t){var n=this,o=e.link.is(n.link),r=n.env.graph;n.link=n.link||e.link.ify(t),n.link[e.link._]=t,n.node&&n.node[i._]&&(n.node[i._][e.link._]=t),c(r,o)&&(r[t]=r[o],u(r,o))}function l(t,o,i,r,a){var u;return!!e.is(t)||(s(t)?1:(u=a.invalid)?l(t=u.call(a.as||{},t,o,i),o,i,r,a):(a.err="Invalid value at '"+r.path.concat(o).join(".")+"'!",void(n.list.is(t)&&(a.err+=" Use `.set(item)` instead of an Array."))))}r.ify=function(n,o,i){var r={path:[],obj:n};return o?"string"==typeof o?o={soul:o}:o instanceof Function&&(o.map=o):o={},o.soul&&(r.link=e.link.ify(o.soul)),o.shell=(i||{}).shell,o.graph=o.graph||{},o.seen=o.seen||[],o.as=o.as||i,t(o,r),o.root=r.node,o.graph}}(),r.node=function(t){var n=i.soul(t);if(n)return f({},n,t)},function(){function t(t,n){var o,a;if(i._!==n)(o=e.link.is(t))?(a=this.opt.seen[o])?this.obj[n]=a:this.obj[n]=this.opt.seen[o]=r.to(this.graph,o,this.opt):this.obj[n]=t;else{if(l(t,e.link._))return;this.obj[n]=d(t)}}r.to=function(n,e,o){if(n){var i={};return o=o||{seen:{}},p(n[e],t,{obj:i,graph:n,opt:o}),i}}}();n.fn.is;var a=n.obj,s=a.is,u=a.del,c=a.has,l=a.empty,f=a.put,p=a.map,d=a.copy;t.exports=r}))(o,"./graph"),o((function(t){o("./onto"),t.exports=function(t,n){if(this.on){if(!(t instanceof Function)){if(!t||!n)return;var e=t["#"]||t,o=(this.tag||empty)[e];if(!o)return;return o=this.on(e,n),clearTimeout(o.err),!0}e=n&&n["#"]||Math.random().toString(36).slice(2);if(!t)return e;var i=this.on(e,t,n);return i.err=i.err||setTimeout((function(){i.next({err:"Error: No ACK received yet.",lack:!0}),i.off()}),(this.opt||{}).lack||9e3),e}}}))(o,"./ask"),o((function(t){var n=o("./type");var e=n.time.is;t.exports=function(t){var o={s:{}};return t=t||{max:1e3,age:27e3},o.check=function(t){var n;return!!(n=o.s[t])&&(n.pass?n.pass=!1:o.track(t))},o.track=function(n,i){var r=o.s[n]||(o.s[n]={});return r.was=e(),i&&(r.pass=!0),o.to||(o.to=setTimeout(o.drop,t.age+9)),r},o.drop=function(i){var r=e();n.obj.map(o.s,(function(e,a){e&&(i||t.age)>r-e.was||n.obj.del(o.s,a)})),o.to=null},o}}))(o,"./dup"),o((function(t){function n(t){return t instanceof n?(this._={gun:this,$:this}).$:this instanceof n?n.create(this._={gun:this,$:this,opt:t}):new n(t)}n.is=function(t){return t instanceof n||t&&t._&&t===t._.$||!1},n.version=.9,n.chain=n.prototype,n.chain.toJSON=function(){};var r=o("./type");r.obj.to(r,n),n.HAM=o("./HAM"),n.val=o("./val"),n.node=o("./node"),n.state=o("./state"),n.graph=o("./graph"),n.on=o("./onto"),n.ask=o("./ask"),n.dup=o("./dup"),function(){function t(e){var o,i,r=this.as,s=r.at||r,u=s.$;(i=e["#"])||(i=e["#"]=l(9)),(o=s.dup).check(i)?r.out===e.out&&(e.out=a,this.to.next(e)):(o.track(i),(i=e["@"])&&o.track(i),s.ask(i,e)||(e.get&&n.on.get(e,u),e.put&&n.on.put(e,u)),this.to.next(e),r.out||(e.out=t,s.on("out",e)))}n.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||n.on,e.ask=e.ask||n.ask,e.dup=e.dup||n.dup();var o=e.$.opt(e.opt);return e.once||(e.on("in",t,e),e.on("out",t,{at:e,out:t}),n.on("create",e),e.on("create",e)),e.once=1,o}}(),function(){n.on.put=function(i,r){var c=r._,l={$:r,graph:c.graph,put:{},map:{},souls:{},machine:n.state(),ack:i["@"],cat:c,stop:{}};if(n.obj.map(i.put,u,l)){if(n.graph.is(i.put,null,e,l)||(l.err="Error: Invalid graph!"),l.err)return c.on("in",{"@":i["#"],err:n.log(l.err)});if(g(l.put,o,l),l.async||g(l.map,s,l),a!==l.defer){var f=l.defer-l.machine;setTimeout((function(){n.on.put(i,r)}),f>t?t:f)}l.diff&&c.on("put",h(i,{put:l.diff}))}};var t=2147483647;function e(t,e,o,i){var r=this,a=n.state.is(o,e);if(!a)return r.err="Error: No state on '"+e+"' in node '"+i+"'!";var s=r.graph[i]||b,u=n.state.is(s,e,!0),c=s[e],l=n.HAM(r.machine,a,u,t,c);l.incoming?(r.put[i]=n.state.to(o,e,r.put[i]),(r.diff||(r.diff={}))[i]=n.state.to(o,e,r.diff[i]),r.souls[i]=!0):l.defer&&(r.defer=a<(r.defer||1/0)?a:r.defer)}function o(t,n){var e=this,o=e.$._,a=(o.next||b)[n];if(!a){if(!(o.opt||b).super)return void(e.souls[n]=!1);a=e.$.get(n)._}var u=e.map[n]={put:t,get:n,$:a.$},c={ctx:e,msg:u};e.async=!!o.tag.node,e.ack&&(u["@"]=e.ack),g(t,i,c),e.async&&(e.and||o.on("node",(function(t){this.to.next(t),t===e.map[t.get]&&(e.souls[t.get]=!1,g(t.put,r,t),g(e.souls,(function(t){if(t)return t}))||e.c||(e.c=1,this.off(),g(e.map,s,e)))})),e.and=!0,o.on("node",u))}function i(t,e){var o=this.ctx,i=o.graph,r=this.msg,a=r.get,s=r.put,u=r.$._;i[a]=n.state.to(s,e,i[a]),o.async||(u.put=n.state.to(s,e,u.put))}function r(t,e){var o=this.put,i=this.$._;i.put=n.state.to(o,e,i.put)}function s(t,n){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}function u(t,n){if(t!==this.graph[n])return!0}n.on.get=function(t,e){var o=e._,i=t.get,r=i[v],a=o.graph[r],s=i[$],u=(o.next||(o.next={}))[r];if(!a)return o.on("get",t);if(s){if("string"!=typeof s||!d(a,s))return o.on("get",t);a=n.state.to(a,s)}else a=n.window?n.obj.copy(a):a;a=n.graph.node(a),(u||b).ack;var c=function(){};c.faith=!0,o.on("in",{"@":t["#"],how:"mem",put:a,$:e,_:c}),o.on("get",t)}}(),n.chain.opt=function(t){t=t||{};var e=this._,o=t.peers||t;return p(t)||(t={}),p(e.opt)||(e.opt=t),c(o)&&(o=[o]),s(o)&&(o=g(o,(function(t,n,e){(n={}).id=n.url=t,e(t,n)})),p(e.opt.peers)||(e.opt.peers={}),e.opt.peers=h(o,e.opt.peers)),e.opt.peers=e.opt.peers||{},g(t,(function t(n,e){!d(this,e)||u.is(n)||f.empty(n)?this[e]=n:n&&n.constructor!==Object&&!s(n)||g(n,t,this[e])}),e.opt),n.on("opt",e),e.opt.uuid=e.opt.uuid||function(){return m()+l(12)},this};var a,s=n.list.is,u=n.text,c=u.is,l=u.random,f=n.obj,p=f.is,d=f.has,h=f.to,g=f.map,m=(f.copy,n.state.lex),v=n.val.link._,$=".",b=(n.node._,n.val.link.is,{});e.only=function(t,n){return e.only.i&&t===e.only.i&&e.only.i++&&(e.log.apply(e,arguments)||n)},n.log=function(){return!n.log.off&&e.log.apply(e,arguments),[].slice.call(arguments).join(" ")},n.log.once=function(t,e,o){return(o=n.log.once)[t]=o[t]||0,o[t]++||n.log(e)},n.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.GUN=window.Gun=n).window=window);try{void 0!==i&&(i.exports=n)}catch(t){}t.exports=n}))(o,"./root"),o((function(t){var n=o("./root");n.chain.back=function(t,o){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var r=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var a=0,s=t.length,u=r;a<s;a++)u=(u||i)[t[a]];return e!==u?o?this:u:(u=r.back)?u.$.back(t,o):void 0}if(t instanceof Function){var c;for(u={back:r};(u=u.back)&&e===(c=t(u,o)););return c}return n.num.is(t)?(r.back||r).$.back(t-1):this};var e,i={}}))(o,"./back"),o((function(t){var n=o("./root");function e(t){var e,o,i=this.as,r=i.back,a=i.root;if(t.$||(t.$=i.$),this.to.next(t),e=t.get){if(i.lex&&(t.get=m(i.lex,t.get)),e["#"]||i.soul){if(e["#"]=e["#"]||i.soul,t["#"]||(t["#"]=$(9)),r=a.$.get(e["#"])._,e=e["."]){if(h(r.put,e)){if((o=(s=r.$.get(e)._).ack)||(s.ack=-1),r.on("in",{$:r.$,put:n.state.to(r.put,e),get:r.get}),o)return}else if("string"!=typeof e){var s={},u=(r.put||{})._;n.obj.map(r.put,(function(t,o){n.text.match(o,e)&&(s[o]=t)})),n.obj.empty(s)||(s._=u,r.on("in",{$:r.$,put:s,get:r.get}))}}else{if((o=r.ack)||(r.ack=-1),h(r,"put")&&r.on("in",r),o&&f!==r.put)return;t.$=r.$}return a.ask(l,t),a.on("in",t)}if(a.now&&(a.now[i.id]=a.now[i.id]||!0,i.pass={}),e["."])return i.get?(t={get:{".":i.get},$:i.$},r.ask||(r.ask={}),r.ask[i.get]=t.$._,r.on("out",t)):(t={get:{},$:i.$},r.on("out",t));if(i.ack=i.ack||-1,i.get)return t.$=i.$,e["."]=i.get,(r.ask||(r.ask={}))[i.get]=t.$._,r.on("out",t)}return r.on("out",t)}function i(t){var e,o,i=this.as,s=i.root,l=(t.$||p)._||p,d=t.put;if(i.get&&t.get!==i.get&&(t=m(t,{get:i.get})),i.has&&l!==i&&(t=m(t,{$:i.$}),l.ack&&(i.ack=l.ack)),f===d){if(o=l.put,this.to.next(t),i.soul)return;if(f===o&&f!==l.put)return;return a(i,t),i.has&&c(i,t),g(l.echo,i.id),void g(i.map,l.id)}if(i.soul)return this.to.next(t),a(i,t),void(i.next&&v(d,u,{msg:t,cat:i}));if(!(e=n.val.link.is(d)))return n.val.is(d)?(i.has||i.soul?c(i,t):(l.has||l.soul)&&((l.echo||(l.echo={}))[i.id]=l.echo[l.id]||i,(i.map||(i.map={}))[l.id]=i.map[l.id]||{at:l}),this.to.next(t),void a(i,t)):(i.has&&l!==i&&h(l,"put")&&(i.put=l.put),(e=n.node.soul(d))&&l.has&&(l.put=i.root.$.get(e)._.put),o=(s.stop||{})[l.id],this.to.next(t),r(i,t,l,e),a(i,t),void(i.next&&v(d,u,{msg:t,cat:i})));s.stop;(o=(o=s.stop||{})[l.id]||(o[l.id]={})).is=o.is||l.put,o[i.id]=l.put||!0,this.to.next(t),r(i,t,l,e),a(i,t)}function r(t,e,o,i){if(i&&b!==t.get){var a=t.root.$.get(i)._;t.has?o=a:o.has&&r(o,e,o,i),o!==t&&(o.$||(o={}),(o.echo||(o.echo={}))[t.id]=o.echo[t.id]||t,t.has&&!(t.map||p)[o.id]&&c(t,e),(i!==(a=o.id?(t.map||(t.map={}))[o.id]=t.map[o.id]||{at:o}:{}).link||a.pass||t.pass)&&(t.pass&&(n.obj.map(t.map,(function(t){t.pass=!0})),g(t,"pass")),a.pass&&g(a,"pass"),t.has&&(t.link=i),function(t,e){var o=t.root.$.get(e)._,i=t.lex;if((t.ack||i)&&((i=i||{})["#"]=e,o.on("out",{get:i}),!t.ask))return;o=t.ask,n.obj.del(t,"ask"),v(o||t.next,(function(t,n){var o=t.lex||{};o["#"]=e,o["."]=o["."]||n,t.on("out",{get:o})})),n.obj.del(t,"ask")}(t,a.link=i)))}}function a(t,n,e){t.echo&&v(t.echo,s,n)}function s(t){t&&t.on&&t.on("in",this)}function u(t,e){var o,i,r,a=this.cat.next||p,s=this.msg;(b!==e||a[e])&&(i=a[e])&&(i.has?(f!==i.put&&n.val.link.is(t)||(i.put=t),o=i.$):(r=s.$)&&(r=(o=s.$.get(e))._,f!==r.put&&n.val.link.is(t)||(r.put=t)),i.on("in",{put:t,get:e,$:o,via:s}))}function c(t,e){if(t.has||t.soul){var o=t.map;t.root;t.map=null,t.has&&(t.dub&&t.root.stop&&(t.dub=null),t.link=null),(t.pass||e["@"]||null!==o)&&(f===o&&n.val.link.is(t.put)||(v(o,(function(n){(n=n.at)&&g(n.echo,t.id)})),o=t.put,v(t.next,(function(n,e){if(f===o&&f!==t.put)return!0;n.put=f,n.ack&&(n.ack=-1),n.on("in",{get:e,$:n.$,put:f})}))))}}function l(t,e){var o=this.as,i=o.get||p,r=o.$._,a=(t.put||p)[i["#"]];if(r.ack&&(r.ack=r.ack+1||1),t.put&&("string"!=typeof i["."]||h(a,r.get)))b!=i["."]?n.on.put(t,r.root.$):r.on("in",{get:r.get,put:n.val.link.ify(i["#"]),$:r.$,"@":t["@"]});else{if(r.put!==f)return;r.on("in",{get:r.get,put:r.put=f,$:r.$,"@":t["@"]})}}n.chain.chain=function(t){var o,r=this._,a=new(t||this).constructor(this),s=a._;return s.root=o=r.root,s.id=++o.once,s.back=this._,s.on=n.on,s.on("in",i,s),s.on("out",e,s),a};var f,p={},d=n.obj,h=d.has,g=(d.put,d.del),m=d.to,v=d.map,$=n.text.random,b=(n.val.link._,n.node._)}))(o,"./chain"),o((function(t){var n=o("./root");function e(t){var e,o=this,i=o.as,a=i.at.root,u=(t.$||{})._||{},l=t.put||u.put;if((e=a.now)&&o!==e[i.now])return o.to.next(t);if(o.seen&&u.id&&o.seen[u.id])return o.to.next(t);if((e=l)&&e[c._]&&(e=c.is(e))&&(e=(t.$$=u.root.gun.get(e))._,r!==e.put&&(t=s(t,{put:l=e.put}))),(e=a.mum)&&u.id){var f=u.id+(o.id||(o.id=n.text.random(9)));if(e[f])return;r===l||c.is(l)||(e[f]=!0)}i.use(t,o),o.stun?o.stun=null:o.to.next(t)}function i(t){var n=this.on;if(!t||n.soul||n.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var e;n.map;if((e=this.seen||(this.seen={}))[t])return!0;e[t]=!0}}n.chain.get=function(t,o,s){var p;if("string"!=typeof t){if(t instanceof Function){if(!0===o)return function(t,n,e,o){var i,a=t._,s=0;if(i=a.soul||a.link||a.dub)return n(i,o,a);if(a.jam)return a.jam.push([n,o]);a.jam=[[n,o]],t.get((function(t,n){if(!(r===t.put&&(i=Object.keys(a.root.opt.peers).length)&&++s<i)){n.rid(t);var e,o=(o=t.$)&&o._||{},u=0;for(i=a.jam,delete a.jam;e=i[u++];){var f=e[0];e=e[1],f&&f(o.link||o.soul||c.is(t.put)||l(t.put)||o.dub,e,t,n)}}}),{out:{get:{".":!0}}})}(this,t,0,s),this;var d,h=(p=this)._,g=h.root,m=g.now;(s=o||{}).at=h,s.use=t,s.out=s.out||{},s.out.get=s.out.get||{},(d=h.on("in",e,s)).rid=i,(g.now={$:1})[s.now=h.id]=d;var v=g.mum;return g.mum={},h.on("out",s.out),g.mum=v,g.now=m,p}return u(t)?this.get(""+t,o,s):(m=c.is(t))?this.get(m,o,s):a.is(t)?(p=this,(m=((m=t["#"])||f)["="]||m)&&(p=p.get(m)),p._.lex=t,p):((s=this.chain())._.err={err:n.log("Invalid get request!",t)},o&&o.call(s,s._.err),s)}return(p=(this._.next||f)[t])||(p=function(t,n){var e=n._,o=e.next,i=n.chain()._;o||(o=e.next={});o[i.get=t]=i,n===e.root.$?i.soul=t:(e.soul||e.has)&&(i.has=t);return i}(t,this)),p=p.$,(m=this._.stun)&&(p._.stun=p._.stun||m),o&&o instanceof Function&&p.get(o,s),p};var r,a=n.obj,s=(a.map,a.has,n.obj.to),u=n.num.is,c=n.val.link,l=n.node.soul,f=(n.node._,{})}))(o,"./get"),o((function(t){var n=o("./root");function e(t){t&&t()}function i(){var t=this;t.graph&&!d(t.stun,r)&&(t.res=t.res||function(t){t&&t()},t.res((function(){var e=t.$.back(-1)._,o=e.ask((function(o){e.root.on("ack",o),o.err&&n.log(o),++i>(t.acks||0)&&this.off(),t.ack&&t.ack(o,this)}),t.opt),i=0,r=e.root.now;l.del(e.root,"now");var a=e.root.mum;e.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":o}),e.root.mum=a?l.to(a,e.root.mum):a,e.root.now=r}),t),t.res&&t.res())}function r(t,n){if(t)return!0}function a(t,e,o,i){var r=this,a=n.is(t);!e&&i.path.length&&(r.res||m)((function(){for(var e=i.path,o=r.ref,u=(r.opt,0),c=e.length;u<c;u++)o=o.get(e[u]);a&&(o=t);var l=o._.dub;if(l||(l=n.node.soul(i.obj)))return o.back(-1).get(l),void i.soul(l);(r.stun=r.stun||{})[e]=!0,o.get(s,!0,{as:{at:i,as:r,p:e}})}),{as:r,at:i})}function s(t,e,o,i){var r=(e=e.as).at;e=e.as;var a=((o||{}).$||{})._||{};t=a.dub=a.dub||t||n.node.soul(r.obj)||n.node.soul(o.put||a.put)||n.val.link.is(o.put||a.put)||(e.via.back("opt.uuid")||n.text.random)(),i&&(i.stun=!0),t?u(a,a.dub=t,r,e):e.via.back("opt.uuid")((function(t,o){if(t)return n.log(t);u(a,a.dub=a.dub||o,r,e)}))}function u(t,n,e,o){t.$.back(-1).get(n),e.soul(n),o.stun[e.path]=!1,o.batch()}function c(t,e,o,i){if(e=e.as,o.$&&o.$._)if(o.err)n.log("Please report this as an issue! Put.any.err");else{var r,a=o.$._,s=a.put,u=e.opt||{};if(!(r=e.ref)||!r._.now){if(i&&(i.stun=!0),e.ref!==e.$){if(!(r=e.$._.get||a.get))return void n.log("Please report this as an issue! Put.no.get");e.data=p({},r,e.data),r=null}if(void 0===s){if(!a.get)return;t||(r=a.$.back((function(t){if(t.link||t.soul)return t.link||t.soul;e.data=p({},t.get,e.data)})),e.not=!0),a=(r=r||a.soul||a.link||a.dub)?a.root.$.get(r)._:a,e.soul=r,s=e.data}e.not||(e.soul=e.soul||t)||(e.path&&f(e.data)?e.soul=(u.uuid||e.via.back("opt.uuid")||n.text.random)():(v==a.get&&(e.soul=(a.put||h)["#"]||a.dub),e.soul=e.soul||a.soul||a.link||(u.uuid||e.via.back("opt.uuid")||n.text.random)()),e.soul)?e.ref.put(e.data,e.soul,e):e.via.back("opt.uuid")((function(t,o){if(t)return n.log(t);e.ref.put(e.data,e.soul=o,e)}))}}}n.chain.put=function(t,o,r){var s,u=this,l=u._,d=l.root.$;d._;return(r=r||{}).data=t,r.via=r.$=r.via||r.$||u,"string"==typeof o?r.soul=o:r.ack=r.ack||o,l.soul&&(r.soul=l.soul),r.soul||d===u?f(r.data)?(r.soul=r.soul||(r.not=n.node.soul(r.data)||(r.via.back("opt.uuid")||n.text.random)()),r.soul?(r.$=d.get(r.soul),r.ref=r.$,function(t){t.batch=i;var e=t.opt||{},o=t.env=n.state.map(a,e.state);if(o.soul=t.soul,t.graph=n.graph.ify(t.data,o,t),o.err)return(t.ack||g).call(t,t.out={err:n.log(o.err)}),void(t.res&&t.res());t.batch()}(r),u):(r.via.back("opt.uuid")((function(t,e){if(t)return n.log(t);(r.ref||r.$).put(r.data,r.soul=e,r)})),u)):((r.ack||g).call(r,r.out={err:n.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),u):n.is(t)?(t.get((function(t,e,i){if(!t)return n.log("The reference you are saving is a",typeof i.put,'"'+i.put+'", not a node (object)!');u.put(n.val.link.ify(t),o,r)}),!0),u):(l.has&&(s=n.val.link.is(t))&&(l.dub=s),r.ref=r.ref||d._===(s=l.back)?u:s.$,r.ref._.soul&&n.val.is(r.data)&&l.get?(r.data=p({},l.get,r.data),r.ref.put(r.data,r.soul,r),u):(r.ref.get(c,!0,{as:r}),r.out||(r.res=r.res||e,r.$._.stun=r.ref._.stun),u))};var l=n.obj,f=l.is,p=l.put,d=l.map,h={},g=function(){},m=function(t,n){t.call(n||h)},v=n.node._}))(o,"./put"),o((function(t){var n=o("./root");o("./chain"),o("./back"),o("./put"),o("./get"),t.exports=n}))(o,"./index"),o((function(t){var n=o("./index");function e(t,n){var e,o=t.$,i=((o||{})._||{}).put||t.put;this.at;if(r!==i){if(e=t.$$){if(e=t.$$._,r===e.put)return;i=e.put}this.change&&(i=t.put),this.as?this.ok.call(this.as,t,n):this.ok.call(o,i,t.get,t,n)}}function i(t,e,o){if(t.$){var a,s,u=this.as,l=(u.at,t.$),f=l._,p=f.put||t.put;(s=t.$$)&&(a=s=t.$$._,r!==a.put&&(p=a.put)),(s=e.wait)&&(s=s[f.id])&&clearTimeout(s),e.ack=(e.ack||0)+1,!o&&r===p&&e.ack<=(u.acks||Object.keys(f.root.opt.peers).length)||(!o&&(r===p||f.soul||f.link||a&&!(0<a.ack))||r===p&&(s=Object.keys(f.root.opt.peers).length)&&!o&&(a||f).ack<s?s=(e.wait={})[f.id]=setTimeout((function(){i.call({as:u},t,e,s||1)}),u.wait||99):(a&&r===a.put&&(s=c.is(p))&&(p=n.node.ify({},s)),e.rid?e.rid(t):e.off(),u.ok.call(l||u.$,p,t.get)))}else e.off()}n.chain.on=function(t,n,o,i){var r,a=this._;if("string"==typeof t)return n?(r=a.on(t,n,o||a,i),o&&o.$&&(o.subs||(o.subs=[])).push(r),this):a.on(t);var s=n;return(s=!0===s?{change:!0}:s||{}).at=a,s.ok=t,this.get(e,s),this},n.chain.val=function(t,e){return n.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,e)},n.chain.once=function(t,e){var o=this,a=o._,s=a.put;if(0<a.ack&&r!==s)return(t||l).call(o,s,a.get),o;if(!t){n.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var u=o.chain();return u._.nix=o.once((function(){u._.on("in",o._)})),u}return(e=e||{}).ok=t,e.at=a,e.out={"#":n.text.random(9)},o.get(i,{as:e}),e.async=!0,o},n.chain.off=function(){var t,n=this._,e=n.back;if(e)return n.ack=0,(t=e.next)&&t[n.get]&&u(t,n.get),(t=e.ask)&&u(t,n.get),(t=e.put)&&u(t,n.get),(t=n.soul)&&u(e.root.graph,t),(t=n.map)&&s(t,(function(t){t.link&&e.root.$.get(t.link).off()})),(t=n.next)&&s(t,(function(t){t.$.off()})),n.on("off",{}),this};var r,a=n.obj,s=a.map,u=(a.has,a.del),c=(a.to,n.val.link),l=function(){}}))(o,"./on"),o((function(t){var n=o("./index");function e(t){if(!t.put||n.val.is(t.put))return this.to.next(t);this.as.nix&&this.off(),r(t.put,i,{at:this.as,msg:t}),this.to.next(t)}function i(t,e){if(s!==e){var o=this.msg.$,i=o._,r=this.at,a=i.lex;a&&!n.text.match(e,a["."]||a["#"]||a)||(((a=o.get(e)._).echo||(a.echo={}))[r.id]=a.echo[r.id]||r)}}n.chain.map=function(t,o,i){var r,s=this._;return t?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),r=this.chain(),this.map().on((function(e,o,i,s){var u=(t||a).call(this,e,o,i,s);if(void 0!==u)return e===u?r._.on("in",i):n.is(u)?r._.on("in",u._):void r._.on("in",{get:o,put:u})})),r):((r=s.each)||(s.each=r=this.chain(),r._.nix=this.back("nix"),this.on("in",e,r._)),r)};var r=n.obj.map,a=function(){},s=n.node._}))(o,"./map"),o((function(t){var n=o("./index");n.chain.set=function(t,e,o){var i,r=this;return e=e||function(){},(o=o||{}).item=o.item||t,(i=n.node.soul(t))&&(t=n.obj.put({},i,n.val.link.ify(i))),n.is(t)?(t.get((function(t,i,a){if(!t)return e.call(r,{err:n.log('Only a node can be linked! Not "'+a.put+'"!')});r.put(n.obj.put({},t,n.val.link.ify(t)),e,o)}),!0),t):(n.obj.is(t)&&(t=r.back(-1).get(i=i||n.node.soul(t)||r.back("opt.uuid")()).put(t)),r.get(i||n.state.lex()+n.text.random(7)).put(t,e,o))}}))(o,"./set"),o((function(t){if("undefined"!=typeof Gun){var n;try{n=(Gun.window||function(){}).localStorage}catch(t){}n||(Gun.log("Warning: No localStorage exists to persist data to!"),n={setItem:function(t,n){this[t]=n},removeItem:function(t){delete this[t]},getItem:function(t){return this[t]}}),Gun.on("create",(function(t){var e=this.to,o=t.opt;if(t.once)return e.next(t);if(!1===o.localStorage)return e.next(t);o.prefix=o.file||"gun/";var i,r,a=Gun.obj.ify(n.getItem("gap/"+o.prefix))||{},s=Gun.obj.empty;if(!s(a)){var u=Gun.obj.ify(n.getItem(o.prefix))||{},c={};Gun.obj.map(a,(function(t,n){Gun.obj.map(t,(function(t,e){c[n]=Gun.state.to(u[n],e,c[n])}))})),setTimeout((function(){t.on("out",{put:c,"#":t.ask(l)})}),1)}function l(t){if(!t.err&&t.ok){var n=t["@"];setTimeout((function(){Gun.obj.map(a,(function(t,e){Gun.obj.map(t,(function(e,o){n===e&&delete t[o]})),s(t)&&delete a[e]})),p()}),o.wait||1)}}t.on("out",(function(t){t.lS||(Gun.is(t.$)&&t.put&&!t["@"]&&(i=t["#"],Gun.graph.is(t.put,null,f),r||(r=setTimeout(p,o.wait||1))),this.to.next(t))})),t.on("ack",l),e.next(t);var f=function(t,n,e,o){(a[o]||(a[o]={}))[n]=i},p=function(){clearTimeout(r),r=!1;try{n.setItem("gap/"+o.prefix,JSON.stringify(a))}catch(t){Gun.log(err=t||"localStorage failure")}}})),Gun.on("create",(function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";t.graph;var o,i={},r=0,a=Gun.obj.ify(n.getItem(e.prefix))||{};t.on("localStorage",a),t.on("put",(function(t){if(this.to.next(t),Gun.graph.is(t.put,null,s),t["@"]||(i[t["#"]]=!0),(r+=1)>=(e.batch||1e3))return u();o||(o=setTimeout(u,e.wait||1))})),t.on("get",(function(n){this.to.next(n);var e,o,i=n.get;function r(){if(i&&(e=i["#"])){var r=i["."];(o=a[e]||void 0)&&r&&(o=Gun.state.to(o,r)),t.on("in",{"@":n["#"],put:Gun.graph.node(o),how:"lS",lS:n.$})}}Gun.debug?setTimeout(r,1):r()}));var s=function(t,n,e,o){a[o]=Gun.state.to(e,n,a[o])},u=function(s){var c;r=0,clearTimeout(o),o=!1;var l=i;i={},s&&(a=s);try{n.setItem(e.prefix,JSON.stringify(a))}catch(n){Gun.log(c=(n||"localStorage failure")+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),t.on("localStorage:error",{err:c,file:e.prefix,flush:a,retry:u})}(c||Gun.obj.empty(e.peers))&&Gun.obj.map(l,(function(n,e){t.on("in",{"@":e,err:c,ok:0})}))}}}))}}))(o,"./adapters/localStorage"),o((function(t){var n=o("../type"),i="undefined"!=typeof setImmediate?setImmediate:setTimeout;function r(t){return t||{_:t._,"##":t["##"]}}!function(){n.text.hash=function(t){if("string"!=typeof t)return{err:1};var n=0;if(!t.length)return n;for(var e=0,o=t.length;e<o;++e)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n};var t=JSON.stringify;function e(t,e){var i;return e instanceof Object?(n.obj.map(Object.keys(e).sort(),o,{to:i={},on:e}),i):e}function o(t){this.to[t]=this.on[t]}n.obj.hash=function(o,i){if(i||void 0!==(o=t(o,e)))return n.text.hash(i||o||"")},n.obj.hash.sort=e}();var a,s=!0,u=e.LOG;try{t.exports=function(t){var o=function(){},c=t.opt||{};c.log=c.log||e.log,c.gap=c.gap||c.wait||1,c.pack=c.pack||.3*(c.memory?1e3*c.memory*1e3:1399e6);var l=t.dup;o.hear=function(e,s){if(e){var p,d,h,g=e[0];if(c.pack<=e.length)return o.say({dam:"!",err:"Message too big!"},s);if("{"!=e[2]&&(o.hear.d+=e.length||0,++o.hear.c),"["===g){try{p=JSON.parse(e)}catch(t){c.log("DAM JSON parse error",t)}if(!p)return;return u&&c.log(+new Date,p.length,"in hear batch"),void function t(){var n;u&&(n=+new Date);for(var e,r=100;r--&&(e=p.shift());)o.hear(e,s);u&&c.log(n,+new Date-n,"batch heard"),p.length&&i(t,0)}()}if("{"===g||n.obj.is(e)&&(p=e)){try{p=p||JSON.parse(e)}catch(t){return c.log("DAM JSON parse error",t)}if(!p)return;if((d=p["#"])||(d=p["#"]=n.text.random(9)),p.DBG_s&&c.log(+new Date-p.DBG_s,"to hear",d),l.check(d))return;if(l.track(d,!0).it=r(p),(h=p["##"])||a===p.put||(h=p["##"]=n.obj.hash(p.put)),h&&(g=p["@"]||p.get&&d)){if(l.check(g+h))return;l.track(g+h,!0).it=r(p)}return(p._=function(){}).via=s,(g=p["><"])&&(p._.to=n.obj.map(g.split(","),f)),p.dam?void((g=o.hear[p.dam])&&g(p,s,t)):(u&&(m=+new Date),t.on("in",p),void(u&&!p.nts&&(v=+new Date-m)>9&&c.log(m,v,"msg",p["#"])));var m,v}}};var f=function(t,n,e){e(t,!0)};function p(t,n){try{var e,i,r=n.wire;u&&(e=+new Date),n.say?n.say(t):r.send&&r.send(t),u&&(i=+new Date-e)>9&&c.log(e,i,"wire send",t.length),o.say.d+=t.length||0,++o.say.c}catch(e){(n.queue=n.queue||[]).push(t)}}o.hear.c=o.hear.d=0,function(){var t,e=0;function i(n){o.say(t,n)}function f(t){var n=t.batch;if(t.batch=t.tail=null,n&&n.length){var e;u&&(e=+new Date);try{n=1===n.length?n[0]:JSON.stringify(n)}catch(t){return c.log("DAM JSON stringify error",t)}u&&c.log(e,+new Date-e,"say stringify",n.length),n&&p(n,t)}}(o.say=function(d,h){if(this.to&&this.to.next(d),!d)return!1;var g,m,v,$,b=d._||(d._=function(){});if((g=d["#"])||(g=d["#"]=n.text.random(9)),(m=d["##"])||a===d.put||(m=d["##"]=n.obj.hash(d.put)),!($=b.raw)&&($=o.raw(d),m&&(v=d["@"])&&(l.track(v+m).it=r(d),v=(l.s[v]||s).it))){if(m===v["##"])return!1;v["##"]=m}if(l.track(g).it=r(d),h||(h=(v=l.s[d["@"]])&&(v=v.it)&&(v=v._)&&(v=v.via)),!h&&d["@"])return u&&c.log(+new Date,++e,"total no peer to ack to"),!1;if(!h&&o.way)return o.way(d);if(!h||!h.id)return t=d,!!n.obj.is(h||c.peers)&&void n.obj.map(h||c.peers,i);if(!h.wire&&o.wire&&o.wire(h),g!==h.last){if(h.last=g,h===b.via)return!1;if((v=b.to)&&(v[h.url]||v[h.pid]||v[h.id]))return!1;if(h.batch){if(h.tail=(v=h.tail||0)+$.length,h.tail<=c.pack)return void h.batch.push($);f(h)}h.batch=[],setTimeout((function(){f(h)}),c.gap),p($,h)}}).c=o.say.d=0}(),function(){o.raw=function(e){if(!e)return"";var o,i=e._||{};if(o=i.raw)return o;if("string"==typeof e)return e;if(!e.dam){var r=0,a=[];n.obj.map(c.peers,(function(t){if(a.push(t.url||t.pid||t.id),++r>3)return!0})),r>1&&(e["><"]=a.join())}var s=t(e);return i&&(s||"").length<1e5&&(i.raw=s),s};var t=JSON.stringify}(),o.hi=function(e){var i=e.wire||{};e.id?c.peers[e.url||e.id]=e:(i=e.id=e.id||n.text.random(9),o.say({dam:"?",pid:t.opt.pid},c.peers[i]=e),delete l.s[e.last]),e.met=e.met||+new Date,i.hied||t.on(i.hied="hi",e),i=e.queue,e.queue=[],n.obj.map(i,(function(t){p(t,e)}))},o.bye=function(n){t.on("bye",n);var i=+new Date;i-=n.met||i,o.bye.time=((o.bye.time||i)+i)/2,u=e.LOG},o.hear["!"]=function(t,n){c.log("Error:",t.err)},o.hear["?"]=function(t,n){t.pid&&(n.pid||(n.pid=t.pid),t["@"])||(o.say({dam:"?",pid:c.pid,"@":t["#"]},n),delete l.s[n.last])},t.on("create",(function(t){t.opt.pid=t.opt.pid||n.text.random(9),this.to.next(t),t.on("out",o.say)})),t.on("bye",(function(t,e){t=c.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(e=t.wire)&&e.close&&e.close(),n.obj.del(c.peers,t.id),t.wire=null}));var d={};return t.on("bye",(function(t,n){this.to.next(t),(n=t.url)&&(d[n]=!0,setTimeout((function(){delete d[n]}),c.lack||9e3))})),t.on("hi",(function(e,i){this.to.next(e),(i=e.url)&&d[i]&&(delete d[i],n.obj.map(t.next,(function(r,a){(i={})[a]=t.graph[a],o.say({"##":n.obj.hash(i),get:{"#":a}},e)})))})),o}}catch(t){}}))(o,"./adapters/mesh"),o((function(t){var n=o("../index");n.Mesh=o("./mesh"),n.on("opt",(function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.WebSocket){var o;"undefined"!=typeof window&&(o=window),void 0!==St&&(o=St),o=o||{};var i=e.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;if(i){e.WebSocket=i;var r=e.mesh=e.mesh||n.Mesh(t);r.wire||e.wire;r.wire=e.wire=s,setTimeout((function(){t.on("out",{dam:"hi"})}),1);var a="undefined"!=typeof document&&document}}function s(t){try{if(!t||!t.url)return o&&o(t);var n=t.url.replace("http","ws"),o=t.wire=new e.WebSocket(n);return o.onclose=function(){e.mesh.bye(t),u(t)},o.onerror=function(n){u(t)},o.onopen=function(){e.mesh.hi(t)},o.onmessage=function(n){n&&e.mesh.hear(n.data||n,t)},o}catch(t){}}function u(t){clearTimeout(t.defer),a&&t.retry<=0||(t.retry=(t.retry||e.retry||60)-1,t.defer=setTimeout((function n(){if(a&&a.hidden)return setTimeout(n,2e3);s(t)}),2e3))}}))}))(o,"./adapters/websocket")}()}));let Tt;!function(){var t="undefined"!=typeof window?window.Gun:Ct;t.on("opt",(function(n){this.to.next(n);var e=n.opt;if(!n.once&&t.Mesh&&!1!==e.RTCPeerConnection){var o;"undefined"!=typeof window&&(o=window),void 0!==St&&(o=St),o=o||{};var i=e.RTCPeerConnection||o.RTCPeerConnection||o.webkitRTCPeerConnection||o.mozRTCPeerConnection,r=e.RTCSessionDescription||o.RTCSessionDescription||o.webkitRTCSessionDescription||o.mozRTCSessionDescription,a=e.RTCIceCandidate||o.RTCIceCandidate||o.webkitRTCIceCandidate||o.mozRTCIceCandidate;if(i&&r&&a){e.RTCPeerConnection=i,e.RTCSessionDescription=r,e.RTCIceCandidate=a,e.rtc=e.rtc||{iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun.sipgate.net:3478"},{url:"stun:stun.stunprotocol.org"},{url:"stun:stun.sipgate.net:10000"},{url:"stun:217.10.68.152:10000"},{url:"stun:stun.services.mozilla.com"}]},e.rtc.dataChannel=e.rtc.dataChannel||{ordered:!1,maxRetransmits:2},e.rtc.sdp=e.rtc.sdp||{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},e.announce=function(t){n.on("out",{rtc:{id:e.pid,to:t}})};var s=e.mesh=e.mesh||t.Mesh(n);n.on("create",(function(t){this.to.next(t),setTimeout(e.announce,1)})),n.on("in",(function(t){t.rtc&&u(t),this.to.next(t)}))}}function u(t){var o,i,r=t.rtc;if(r&&r.id){if(delete e.announce[r.id],i=r.answer){if(!(o=e.peers[r.id]||u[r.id])||o.remoteSet)return;return o.setRemoteDescription(o.remoteSet=new e.RTCSessionDescription(i))}if(i=r.candidate)return(o=e.peers[r.id]||u[r.id]||u({rtc:{id:r.id}})).addIceCandidate(new e.RTCIceCandidate(i));if(!u[r.id]){(o=new e.RTCPeerConnection(e.rtc)).id=r.id;var a=o.wire=o.createDataChannel("dc",e.rtc.dataChannel);return u[r.id]=o,a.onclose=function(){delete u[r.id],s.bye(o)},a.onerror=function(t){},a.onopen=function(t){s.hi(o)},a.onmessage=function(t){t&&s.hear(t.data||t,o)},o.onicecandidate=function(o){o.candidate&&n.on("out",{"@":t["#"],rtc:{candidate:o.candidate,id:e.pid}})},o.ondatachannel=function(t){var n=t.channel;n.onmessage=a.onmessage,n.onopen=a.onopen,n.onclose=a.onclose},(i=r.offer)?(o.setRemoteDescription(new e.RTCSessionDescription(i)),void o.createAnswer((function(i){o.setLocalDescription(i),n.on("out",{"@":t["#"],rtc:{answer:i,id:e.pid}})}),(function(){}),e.rtc.sdp)):(o.createOffer((function(i){o.setLocalDescription(i),n.on("out",{"@":t["#"],rtc:{offer:i,id:e.pid}})}),(function(){}),e.rtc.sdp),o)}}}}))}(),Tt=["https://www.raygun.live/gun","https://gunmeetingserver.herokuapp.com/gun","https://gun-us.herokuapp.com/gun","https://gun-eu.herokuapp.com/gun"];const Ot=new Ct({peers:Tt});function Dt(t){const n=t-1;return n*n*n+1}function Rt(t){return--t*t*t*t*t+1}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Mt(t,{delay:e=0,duration:o=400,easing:i=n}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:o,easing:i,css:t=>"opacity: "+t*r}}function Gt(t,{delay:n=0,duration:e=400,easing:o=Dt,x:i=0,y:r=0,opacity:a=0}){const s=getComputedStyle(t),u=+s.opacity,c="none"===s.transform?"":s.transform,l=u*(1-a);return{delay:n,duration:e,easing:o,css:(t,n)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*r}px);\n\t\t\topacity: ${u-l*n}`}}function It(t){var{fallback:n}=t,o=function(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(e[o[i]]=t[o[i]])}return e}(t,["fallback"]);const i=new Map,r=new Map;function s(t,i,r){return(s,u)=>(t.set(u.key,{rect:s.getBoundingClientRect()}),()=>{if(i.has(u.key)){const{rect:t}=i.get(u.key);return i.delete(u.key),function(t,n,i){const{delay:r=0,duration:s=(t=>30*Math.sqrt(t)),easing:u=Dt}=e(e({},o),i),c=n.getBoundingClientRect(),l=t.left-c.left,f=t.top-c.top,p=t.width/c.width,d=t.height/c.height,h=Math.sqrt(l*l+f*f),g=getComputedStyle(n),m="none"===g.transform?"":g.transform,v=+g.opacity;return{delay:r,duration:a(s)?s(h):s,easing:u,css:(t,n)=>`\n\t\t\t\topacity: ${t*v};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${m} translate(${n*l}px,${n*f}px) scale(${t+(1-t)*p}, ${t+(1-t)*d});\n\t\t\t`}}(t,s,u)}return t.delete(u.key),n&&n(s,u,r)})}return[s(r,i,!1),s(i,r,!0)]}function Nt(t){let n,e,o,i,r,s;return{c(){n=x("div"),e=x("button"),e.textContent="â†“",O(e,"class","svelte-1co9mdl"),O(n,"class","svelte-1co9mdl")},m(o,i,u){y(o,n,i),b(n,e),r=!0,u&&s(),s=C(e,"click",T((function(){a(t[0])&&t[0].apply(this,arguments)})))},p(n,[e]){t=n},i(t){r||(V(()=>{i&&i.end(1),o||(o=ft(n,Gt,{x:20,duration:200})),o.start()}),r=!0)},o(t){o&&o.invalidate(),i=pt(n,Gt,{x:20,duration:200}),r=!1},d(t){t&&k(n),t&&i&&i.end(),s()}}}function At(t,n,e){let{onScroll:o}=n;return t.$set=t=>{"onScroll"in t&&e(0,o=t.onScroll)},[o]}window.gun=Ot;class Lt extends yt{constructor(t){super(),bt(this,t,At,Nt,s,{onScroll:0})}}function Et(t){let n,e;return{c(){n=x("input"),n.disabled=t[6],O(n,"rows",t[8]),O(n,"class","input svelte-c4fbvv"),O(n,"type","text"),O(n,"maxlength",t[5]),O(n,"name",t[4]),O(n,"aria-labelledby",t[1]),O(n,"aria-label",t[2]),O(n,"placeholder",t[3])},m(o,i,r){y(o,n,i),R(n,t[0]),r&&e(),e=C(n,"input",t[12])},p(t,e){64&e&&(n.disabled=t[6]),256&e&&O(n,"rows",t[8]),32&e&&O(n,"maxlength",t[5]),16&e&&O(n,"name",t[4]),2&e&&O(n,"aria-labelledby",t[1]),4&e&&O(n,"aria-label",t[2]),8&e&&O(n,"placeholder",t[3]),1&e&&n.value!==t[0]&&R(n,t[0])},d(t){t&&k(n),e()}}}function Pt(t){let n,e;return{c(){n=x("textarea"),O(n,"name",t[4]),n.disabled=t[6],O(n,"class","input svelte-c4fbvv"),O(n,"type","text"),O(n,"maxlength",t[5]),O(n,"rows",t[8]),O(n,"aria-label",t[2]),O(n,"aria-labelledby",t[1]),O(n,"placeholder",t[3])},m(o,i,a){y(o,n,i),R(n,t[0]),a&&r(e),e=[C(n,"input",t[11]),C(n,"keypress",Ht)]},p(t,e){16&e&&O(n,"name",t[4]),64&e&&(n.disabled=t[6]),32&e&&O(n,"maxlength",t[5]),256&e&&O(n,"rows",t[8]),4&e&&O(n,"aria-label",t[2]),2&e&&O(n,"aria-labelledby",t[1]),8&e&&O(n,"placeholder",t[3]),1&e&&R(n,t[0])},d(t){t&&k(n),r(e)}}}function Bt(t){let n,e,o,i;return{c(){n=x("input"),O(n,"class","submit svelte-c4fbvv"),O(n,"type","submit"),n.value="Send"},m(t,e){y(t,n,e),i=!0},i(t){i||(V(()=>{o&&o.end(1),e||(e=ft(n,Mt,{})),e.start()}),i=!0)},o(t){e&&e.invalidate(),o=pt(n,Mt,{}),i=!1},d(t){t&&k(n),t&&o&&o.end()}}}function Jt(t){let n,e,o;function i(t,n){return t[7]?Pt:Et}let r=i(t),a=r(t),s=t[0]&&Bt();return{c(){n=x("div"),a.c(),e=j(),s&&s.c(),O(n,"class","input-with-button svelte-c4fbvv")},m(t,i){y(t,n,i),a.m(n,null),b(n,e),s&&s.m(n,null),o=!0},p(t,[o]){r===(r=i(t))&&a?a.p(t,o):(a.d(1),a=r(t),a&&(a.c(),a.m(n,e))),t[0]?s?1&o&&ut(s,1):(s=Bt(),s.c(),ut(s,1),s.m(n,null)):s&&(at(),ct(s,1,1,()=>{s=null}),st())},i(t){o||(ut(s),o=!0)},o(t){ct(s),o=!1},d(t){t&&k(n),a.d(),s&&s.d()}}}function Ht(t){13!==t.which||t.shiftKey||(t.target.form.dispatchEvent(new Event("submit",{cancelable:!0})),t.preventDefault())}function zt(t,n,e){let o,{ariaLabelledBy:i=null}=n,{ariaLabel:r=null}=n,{placeholder:a=null}=n,{value:s=""}=n,{name:u=null}=n,{maxLength:c=160}=n,{maxRows:l=1}=n,{disabled:f=!1}=n,{multiline:p=!1}=n;function d(t){let n=Math.floor(t.length/40)+1;return n+=(t.match(/\n/g)||[]).length,Math.min(l,n)}return t.$set=t=>{"ariaLabelledBy"in t&&e(1,i=t.ariaLabelledBy),"ariaLabel"in t&&e(2,r=t.ariaLabel),"placeholder"in t&&e(3,a=t.placeholder),"value"in t&&e(0,s=t.value),"name"in t&&e(4,u=t.name),"maxLength"in t&&e(5,c=t.maxLength),"maxRows"in t&&e(9,l=t.maxRows),"disabled"in t&&e(6,f=t.disabled),"multiline"in t&&e(7,p=t.multiline)},t.$$.update=()=>{1&t.$$.dirty&&e(8,o=d(s))},[s,i,r,a,u,c,f,p,o,l,d,function(){s=this.value,e(0,s)},function(){s=this.value,e(0,s)}]}class Ft extends yt{constructor(t){super(),bt(this,t,zt,Jt,s,{ariaLabelledBy:1,ariaLabel:2,placeholder:3,value:0,name:4,maxLength:5,maxRows:9,disabled:6,multiline:7})}}function qt(t){let n,e,o,i,r;function a(n){t[3].call(null,n)}let s={multiline:!0,disabled:!t[1],maxRows:3,name:"msg",placeholder:"Message",ariaLabel:"Message"};void 0!==t[0]&&(s.value=t[0]);const u=new Ft({props:s});return F.push(()=>ht(u,"value",a)),{c(){n=x("div"),e=x("form"),gt(u.$$.fragment),O(e,"method","get"),O(e,"autocomplete","off"),O(e,"class","svelte-1djjhy7"),O(n,"class","svelte-1djjhy7")},m(o,a,s){y(o,n,a),b(n,e),mt(u,e,null),i=!0,s&&r(),r=C(e,"submit",T(t[4]))},p(t,[n]){const e={};2&n&&(e.disabled=!t[1]),!o&&1&n&&(o=!0,e.value=t[0],Q(()=>o=!1)),u.$set(e)},i(t){i||(ut(u.$$.fragment,t),i=!0)},o(t){ct(u.$$.fragment,t),i=!1},d(t){t&&k(n),vt(u),r()}}}function Wt(t,n,e){let o;u(t,jt,t=>e(1,o=t));const i=H();let r;return[r,o,i,function(t){r=t,e(0,r)},t=>{r&&r.trim()&&(i("message",r),e(0,r=""),t.target.msg.focus())}]}class Kt extends yt{constructor(t){super(),bt(this,t,Wt,qt,s,{})}}function Ut(t){if(!t)return;const n=[60,360],e=[75,100],o=[70,71];function i(t,n,e){const o=e-n;return(t%o+o)%o+n}let r=0;if(0===t)return r;for(let n=0;n<t.length;n++)r=t.charCodeAt(n)+((r<<5)-r),r&=r;return`hsl(${i(r,n[0],n[1])}, ${i(r,e[0],e[1])}%, ${i(r,o[0],o[1])}%)`}function Vt(t,n,e){const o=t.slice();return o[6]=n[e],o}function Qt(t){let n,e;function o(...n){return t[5](t[6],...n)}return{c(){n=x("button"),n.textContent="delete",O(n,"class","delete svelte-n2su4y")},m(t,i,r){y(t,n,i),r&&e(),e=C(n,"click",T(o))},p(n,e){t=n},d(t){t&&k(n),e()}}}function Xt(t,n){let e,o,i,r,a,s,u,c,l,f,p,d,h,g,m,v=new Date(parseFloat(n[6].time)).toLocaleString("en-US",{hour12:!1})+"",$=n[6].user+"",w=n[6].msg+"",S=n[6].user===n[1]&&Qt(n);return{key:t,first:null,c(){e=x("article"),o=x("div"),i=x("span"),r=_(v),a=j(),s=x("span"),u=_($),c=j(),l=x("div"),f=_(w),p=j(),S&&S.c(),d=j(),O(i,"class","time"),O(s,"class","user svelte-n2su4y"),O(o,"class","meta svelte-n2su4y"),O(l,"class","msg svelte-n2su4y"),M(l,"background-color",n[6].user!==n[1]&&Ut(n[6].user)),O(e,"class","svelte-n2su4y"),G(e,"user",n[6].user===n[1]),this.first=e},m(t,n){y(t,e,n),b(e,o),b(o,i),b(i,r),b(o,a),b(o,s),b(s,u),b(e,c),b(e,l),b(l,f),b(l,p),S&&S.m(l,null),b(e,d),m=!0},p(t,n){(!m||1&n)&&v!==(v=new Date(parseFloat(t[6].time)).toLocaleString("en-US",{hour12:!1})+"")&&D(r,v),(!m||1&n)&&$!==($=t[6].user+"")&&D(u,$),(!m||1&n)&&w!==(w=t[6].msg+"")&&D(f,w),t[6].user===t[1]?S?S.p(t,n):(S=Qt(t),S.c(),S.m(l,null)):S&&(S.d(1),S=null),(!m||3&n)&&M(l,"background-color",t[6].user!==t[1]&&Ut(t[6].user)),3&n&&G(e,"user",t[6].user===t[1])},i(t){m||(V(()=>{g&&g.end(1),h||(h=ft(e,Mt,{})),h.start()}),m=!0)},o(t){h&&h.invalidate(),g=pt(e,n[3],{key:n[6].msgId}),m=!1},d(t){t&&k(e),S&&S.d(),t&&g&&g.end()}}}function Yt(t){let n,e,o=[],i=new Map,r=t[0];const a=t=>t[6].msgId;for(let n=0;n<r.length;n+=1){let e=Vt(t,r,n),s=a(e);i.set(s,o[n]=Xt(s,e))}return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=S()},m(t,i){for(let n=0;n<o.length;n+=1)o[n].m(t,i);y(t,n,i),e=!0},p(t,[e]){if(7&e){const r=t[0];at(),o=function(t,n,e,o,i,r,a,s,u,c,l,f){let p=t.length,d=r.length,h=p;const g={};for(;h--;)g[t[h].key]=h;const m=[],v=new Map,$=new Map;for(h=d;h--;){const t=f(i,r,h),s=e(t);let u=a.get(s);u?o&&u.p(t,n):(u=c(s,t),u.c()),v.set(s,m[h]=u),s in g&&$.set(s,Math.abs(h-g[s]))}const b=new Set,y=new Set;function k(t){ut(t,1),t.m(s,l,a.has(t.key)),a.set(t.key,t),l=t.first,d--}for(;p&&d;){const n=m[d-1],e=t[p-1],o=n.key,i=e.key;n===e?(l=n.first,p--,d--):v.has(i)?!a.has(o)||b.has(o)?k(n):y.has(i)?p--:$.get(o)>$.get(i)?(y.add(o),k(n)):(b.add(i),p--):(u(e,a),p--)}for(;p--;){const n=t[p];v.has(n.key)||u(n,a)}for(;d;)k(m[d-1]);return m}(o,e,a,1,t,r,i,n.parentNode,dt,Xt,n,Vt),st()}},i(t){if(!e){for(let t=0;t<r.length;t+=1)ut(o[t]);e=!0}},o(t){for(let t=0;t<o.length;t+=1)ct(o[t]);e=!1},d(t){for(let n=0;n<o.length;n+=1)o[n].d(t);t&&k(n)}}}function Zt(t,n,e){let o;u(t,jt,t=>e(1,o=t));const i=H();let{chats:r}=n;const[a,s]=It({duration:t=>Math.sqrt(200*t),fallback(t,n){const e=getComputedStyle(t),o="none"===e.transform?"":e.transform;return{duration:600,easing:Rt,css:t=>`\n          transform: ${o} scale(${t});\n          opacity: ${t}\n\t\t\t\t`}}});return t.$set=t=>{"chats"in t&&e(0,r=t.chats)},[r,o,i,a,s,t=>{confirm("Are you sure?")&&i("delete",t.msgId)}]}class tn extends yt{constructor(t){super(),bt(this,t,Zt,Yt,s,{chats:0})}}function nn(n){let e;return{c(){e=x("div"),e.innerHTML='<div class="loadingspinner"></div>',O(e,"class","centered")},m(t,n){y(t,e,n)},p:t,i:t,o:t,d(t){t&&k(e)}}}class en extends yt{constructor(t){super(),bt(this,t,null,nn,s,{})}}function on(t){let n;const e=new en({});return{c(){gt(e.$$.fragment)},m(t,o){mt(e,t,o),n=!0},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){vt(e,t)}}}function rn(n){let e;const o=new Lt({props:{onScroll:n[4]}});return{c(){gt(o.$$.fragment)},m(t,n){mt(o,t,n),e=!0},p:t,i(t){e||(ut(o.$$.fragment,t),e=!0)},o(t){ct(o.$$.fragment,t),e=!1},d(t){vt(o,t)}}}function an(t){let n,e,o,i,r,a,s,u=t[3]&&on();const c=new tn({props:{chats:t[0]}});c.$on("delete",t[14]);const l=new Kt({});l.$on("message",t[16]);let f=t[1]&&rn(t);return{c(){n=x("main"),u&&u.c(),e=j(),gt(c.$$.fragment),o=j(),gt(l.$$.fragment),i=j(),f&&f.c(),r=S(),O(n,"class","svelte-i15h9r")},m(p,d,h){y(p,n,d),u&&u.m(n,null),b(n,e),mt(c,n,null),t[15](n),y(p,o,d),mt(l,p,d),y(p,i,d),f&&f.m(p,d),y(p,r,d),a=!0,h&&s(),s=C(n,"scroll",t[5])},p(t,[o]){t[3]?u?8&o&&ut(u,1):(u=on(),u.c(),ut(u,1),u.m(n,e)):u&&(at(),ct(u,1,1,()=>{u=null}),st());const i={};1&o&&(i.chats=t[0]),c.$set(i),t[1]?f?(f.p(t,o),2&o&&ut(f,1)):(f=rn(t),f.c(),ut(f,1),f.m(r.parentNode,r)):f&&(at(),ct(f,1,1,()=>{f=null}),st())},i(t){a||(ut(u),ut(c.$$.fragment,t),ut(l.$$.fragment,t),ut(f),a=!0)},o(t){ct(u),ct(c.$$.fragment,t),ct(l.$$.fragment,t),ct(f),a=!1},d(e){e&&k(n),u&&u.d(),vt(c),t[15](null),e&&k(o),vt(l,e),e&&k(i),f&&f.d(e),e&&k(r),s()}}}function sn(t,n,e){let o,i;u(t,jt,t=>e(12,o=t)),u(t,_t,t=>e(13,i=t));let r,a,s,c,l=100,f={},p=[],d=!1;function h(){s.scrollTo({left:0,top:s.scrollHeight})}function g(t){const n=(new Date).getTime(),e={msg:t,user:o,time:n};Ot.get(i).set(e)}function m(t){Ot.get(i).get(t).put(null)}var v;v=async()=>{Ot.get(i).map().on((t,n)=>{t?e(9,f[n]={msgId:n,...t},f):(delete f[n],e(9,f))})},J().$$.on_mount.push(v),function(t){J().$$.before_update.push(t)}(()=>{r=s&&s.offsetHeight+s.scrollTop>s.scrollHeight-50}),function(t){J().$$.after_update.push(t)}(()=>{r&&s.scrollTo(0,s.scrollHeight)}),function(t){J().$$.on_destroy.push(t)}(()=>{Ot.get(i).off()});return t.$$.update=()=>{2816&t.$$.dirty&&(e(3,d=!0),c&&clearTimeout(c),e(11,c=setTimeout(()=>{const t=Object.values(f),n=t.sort((t,n)=>t.time-n.time),o=Math.max(0,n.length-l),i=t.length;e(0,p=t.slice(o,i)),e(3,d=!1)},200)))},[p,a,s,d,h,function(t){if(e(1,a=s.scrollHeight-s.offsetHeight>s.scrollTop+300),!d&&s.scrollTop<=s.scrollHeight/10){const t=Object.keys(f).length-1;if(l>=t)return;e(3,d=!0),setTimeout(()=>{e(8,l+=50),0===s.scrollTop&&e(2,s.scrollTop=1,s),e(3,d=!1)},200)}},g,m,l,f,r,c,o,i,t=>{m(t.detail)},function(t){F[t?"unshift":"push"](()=>{e(2,s=t)})},t=>{g(t.detail),h()}]}class un extends yt{constructor(t){super(),bt(this,t,sn,an,s,{})}}function cn(t){let n,e,o,i,r,a,s,u,c,l,f;function p(n){t[3].call(null,n)}let d={maxLength:"50",placeholder:"Steve Jobs",ariaLabelledBy:"name-label"};void 0!==t[0]&&(d.value=t[0]);const h=new Ft({props:d});function g(n){t[4].call(null,n)}F.push(()=>ht(h,"value",p));let m={maxLength:"50",placeholder:"Chat topic",ariaLabelledBy:"chat-label"};void 0!==t[2]&&(m.value=t[2]);const v=new Ft({props:m});return F.push(()=>ht(v,"value",g)),{c(){n=x("main"),e=x("form"),o=x("label"),o.textContent="ENTER YOUR NICKNAME",i=j(),gt(h.$$.fragment),a=j(),s=x("label"),s.textContent="CHAT TOPIC",u=j(),gt(v.$$.fragment),O(o,"id","name-label"),O(o,"class","svelte-11z0eya"),O(s,"id","chat-label"),O(s,"class","svelte-11z0eya"),O(e,"class","svelte-11z0eya"),O(n,"class","svelte-11z0eya")},m(r,c,p){y(r,n,c),b(n,e),b(e,o),b(e,i),mt(h,e,null),b(e,a),b(e,s),b(e,u),mt(v,e,null),l=!0,p&&f(),f=C(e,"submit",T(t[5]))},p(t,[n]){const e={};!r&&1&n&&(r=!0,e.value=t[0],Q(()=>r=!1)),h.$set(e);const o={};!c&&4&n&&(c=!0,o.value=t[2],Q(()=>c=!1)),v.$set(o)},i(t){l||(ut(h.$$.fragment,t),ut(v.$$.fragment,t),l=!0)},o(t){ct(h.$$.fragment,t),ct(v.$$.fragment,t),l=!1},d(t){t&&k(n),vt(h),vt(v),f()}}}function ln(t,n,e){let o,i,r;u(t,jt,t=>e(0,o=t)),u(t,wt,t=>e(1,i=t)),u(t,_t,t=>e(2,r=t));return[o,i,r,function(t){o=t,jt.set(o)},function(t){r=t,_t.set(r)},t=>{o&&p(wt,i="messages")}]}class fn extends yt{constructor(t){super(),bt(this,t,ln,cn,s,{})}}function pn(t){let n,e,o,i,r,a=t[1]&&dn(t);return{c(){n=x("button"),e=w("svg"),o=w("path"),i=j(),a&&a.c(),O(o,"fill","currentColor"),O(o,"d","M13.7 15.3a1 1 0 0 1-1.4 1.4l-4-4a1 1 0 0 1 0-1.4l4-4a1 1 0 0 1 1.4\n          1.4L10.42 12l3.3 3.3z"),O(e,"height","40"),O(e,"width","40"),O(e,"xmlns","http://www.w3.org/2000/svg"),O(e,"viewBox","0 0 24 24"),O(n,"class","svelte-gao1x3")},m(s,u,c){y(s,n,u),b(n,e),b(e,o),b(n,i),a&&a.m(n,null),c&&r(),r=C(n,"click",t[5])},p(t,e){t[1]?a?a.p(t,e):(a=dn(t),a.c(),a.m(n,null)):a&&(a.d(1),a=null)},d(t){t&&k(n),a&&a.d(),r()}}}function dn(t){let n,e;return{c(){n=x("span"),e=_(t[1]),O(n,"class","svelte-gao1x3")},m(t,o){y(t,n,o),b(n,e)},p(t,n){2&n&&D(e,t[1])},d(t){t&&k(n)}}}function hn(t){let n,e,o,i,r=t[0]&&pn(t);const a=t[4].default,s=c(a,t,t[3],null);return{c(){n=x("nav"),r&&r.c(),e=j(),o=x("h1"),s&&s.c(),O(o,"class","svelte-gao1x3"),O(n,"class","svelte-gao1x3")},m(t,a){y(t,n,a),r&&r.m(n,null),b(n,e),b(n,o),s&&s.m(o,null),i=!0},p(t,[o]){t[0]?r?r.p(t,o):(r=pn(t),r.c(),r.m(n,e)):r&&(r.d(1),r=null),s&&s.p&&8&o&&s.p(l(a,t,t[3],null),f(a,t[3],o,null))},i(t){i||(ut(s,t),i=!0)},o(t){ct(s,t),i=!1},d(t){t&&k(n),r&&r.d(),s&&s.d(t)}}}function gn(t,n,e){let{showBack:o=!1}=n,{backText:i=null}=n;const r=H();let{$$slots:a={},$$scope:s}=n;return t.$set=t=>{"showBack"in t&&e(0,o=t.showBack),"backText"in t&&e(1,i=t.backText),"$$scope"in t&&e(3,s=t.$$scope)},[o,i,r,s,a,()=>r("back")]}class mn extends yt{constructor(t){super(),bt(this,t,gn,hn,s,{showBack:0,backText:1})}}function vn(t){let n,e,o,i,r;const a=t[1].default,s=c(a,t,t[0],null);return{c(){n=x("div"),e=x("div"),s&&s.c(),O(e,"class","container svelte-lj276o"),O(n,"class","animation svelte-lj276o")},m(t,o){y(t,n,o),b(n,e),s&&s.m(e,null),r=!0},p(t,[n]){s&&s.p&&1&n&&s.p(l(a,t,t[0],null),f(a,t[0],n,null))},i(t){r||(ut(s,t),V(()=>{i&&i.end(1),o||(o=ft(n,Mt,{})),o.start()}),r=!0)},o(t){ct(s,t),o&&o.invalidate(),i=pt(n,Mt,{}),r=!1},d(t){t&&k(n),s&&s.d(t),t&&i&&i.end()}}}function $n(t,n,e){let{$$slots:o={},$$scope:i}=n;return t.$set=t=>{"$$scope"in t&&e(0,i=t.$$scope)},[i,o]}class bn extends yt{constructor(t){super(),bt(this,t,$n,vn,s,{})}}function yn(n){let e,o,i,r,a,s,u,c,l,f,p,d,h,g,m,v,$,w,S;return{c(){e=x("footer"),o=_("Made with\n  "),i=x("span"),i.textContent="â™¥ï¸",r=_("\n  by\n  "),a=x("a"),a.textContent="Koen van Gilst",s=j(),u=x("br"),c=_("\n  Using\n  "),l=x("a"),l.textContent="svelte",f=_("\n  and\n  "),p=x("a"),p.textContent="gunDB",d=_("\n  see\n  "),h=x("a"),h.textContent="Github",g=j(),m=x("br"),v=_("\n  v. "),$=_("0.9.0"),w=_(" git "),S=_("a86dab6"),O(i,"class","svelte-17ail42"),O(a,"href","https://koenvangilst.nl"),O(l,"href","https://svelte.dev/"),O(p,"href","https://gun.eco/"),O(h,"href","https://github.com/vnglst/svelte-gundb-chat"),O(e,"class","svelte-17ail42")},m(t,n){y(t,e,n),b(e,o),b(e,i),b(e,r),b(e,a),b(e,s),b(e,u),b(e,c),b(e,l),b(e,f),b(e,p),b(e,d),b(e,h),b(e,g),b(e,m),b(e,v),b(e,$),b(e,w),b(e,S)},p:t,i:t,o:t,d(t){t&&k(e)}}}class kn extends yt{constructor(t){super(),bt(this,t,null,yn,s,{})}}function xn(t){let n;const e=new bn({props:{$$slots:{default:[jn]},$$scope:{ctx:t}}});return{c(){gt(e.$$.fragment)},m(t,o){mt(e,t,o),n=!0},p(t,n){const o={};5&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){vt(e,t)}}}function wn(t){let n;const e=new bn({props:{$$slots:{default:[Cn]},$$scope:{ctx:t}}});return{c(){gt(e.$$.fragment)},m(t,o){mt(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ut(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){vt(e,t)}}}function _n(t){let n;return{c(){n=_("Messages")},m(t,e){y(t,n,e)},d(t){t&&k(n)}}}function jn(t){let n,e;const o=new mn({props:{showBack:!0,backText:"Sign In",$$slots:{default:[_n]},$$scope:{ctx:t}}});o.$on("back",t[1]);const i=new un({});return{c(){gt(o.$$.fragment),n=j(),gt(i.$$.fragment)},m(t,r){mt(o,t,r),y(t,n,r),mt(i,t,r),e=!0},p(t,n){const e={};4&n&&(e.$$scope={dirty:n,ctx:t}),o.$set(e)},i(t){e||(ut(o.$$.fragment,t),ut(i.$$.fragment,t),e=!0)},o(t){ct(o.$$.fragment,t),ct(i.$$.fragment,t),e=!1},d(t){vt(o,t),t&&k(n),vt(i,t)}}}function Sn(t){let n;return{c(){n=_("Sign In")},m(t,e){y(t,n,e)},d(t){t&&k(n)}}}function Cn(t){let n,e,o;const i=new mn({props:{$$slots:{default:[Sn]},$$scope:{ctx:t}}}),r=new fn({}),a=new kn({});return{c(){gt(i.$$.fragment),n=j(),gt(r.$$.fragment),e=j(),gt(a.$$.fragment)},m(t,s){mt(i,t,s),y(t,n,s),mt(r,t,s),y(t,e,s),mt(a,t,s),o=!0},p(t,n){const e={};4&n&&(e.$$scope={dirty:n,ctx:t}),i.$set(e)},i(t){o||(ut(i.$$.fragment,t),ut(r.$$.fragment,t),ut(a.$$.fragment,t),o=!0)},o(t){ct(i.$$.fragment,t),ct(r.$$.fragment,t),ct(a.$$.fragment,t),o=!1},d(t){vt(i,t),t&&k(n),vt(r,t),t&&k(e),vt(a,t)}}}function Tn(t){let n,e,o,i;const r=[wn,xn],a=[];function s(t,n){return"settings"===t[0]?0:"messages"===t[0]?1:-1}return~(n=s(t))&&(e=a[n]=r[n](t)),{c(){e&&e.c(),o=S()},m(t,e){~n&&a[n].m(t,e),y(t,o,e),i=!0},p(t,[i]){let u=n;n=s(t),n===u?~n&&a[n].p(t,i):(e&&(at(),ct(a[u],1,1,()=>{a[u]=null}),st()),~n?(e=a[n],e||(e=a[n]=r[n](t),e.c()),ut(e,1),e.m(o.parentNode,o)):e=null)},i(t){i||(ut(e),i=!0)},o(t){ct(e),i=!1},d(t){~n&&a[n].d(t),t&&k(o)}}}function On(t,n,e){let o;u(t,wt,t=>e(0,o=t));return[o,()=>{p(wt,o="settings")}]}document.body.innerHTML="";const Dn=new class extends yt{constructor(t){super(),bt(this,t,On,Tn,s,{})}}({target:document.body});return"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("serviceworker.js")}),Dn}();
//# sourceMappingURL=bundle.js.map
